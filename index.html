<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>星语占星 Pro - 专业星盘测算</title>
    <style>
        :root { 
            --primary: #a29bfe; 
            --bg: #05071a; 
            --card: rgba(26, 28, 58, 0.7); /* 半透明磨砂 */
            --border: rgba(162, 155, 254, 0.3);
        }

        /* 1. 动态星空底层 */
        @keyframes starsRotate {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100px); }
        }
        
        body { 
            background: var(--bg); 
            color: white; 
            font-family: -apple-system, "SF Pro Display", sans-serif; 
            margin: 0; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: "★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★ . * ✦ . * ★";
            position: fixed;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            z-index: -1;
            color: rgba(255, 255, 255, 0.3);
            font-size: 22px;
            line-height: 1.8;
            letter-spacing: 40px;
            word-break: break-all;
            pointer-events: none;
            animation: starsRotate 20s linear infinite;
        }

        h1 { color: var(--primary); margin: 10px 0 25px 0; font-weight: 300; letter-spacing: 2px; text-shadow: 0 0 10px rgba(162, 155, 254, 0.5); }

        /* 2. 磨砂玻璃容器 */
        .config-box, .card, .tab, .modal-content {
            background: var(--card);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: 20px;
        }

        .config-box { padding: 18px; width: 100%; max-width: 400px; margin-bottom: 20px; box-sizing: border-box; }
        .input-row { display: flex; gap: 10px; margin-bottom: 12px; }
        input, select { background: rgba(255,255,255,0.05); border: 1px solid var(--border); color: white; padding: 12px; border-radius: 12px; flex: 1; outline: none; font-size: 14px; }

        .tabs { display: flex; gap: 10px; margin-bottom: 20px; width: 100%; max-width: 400px; overflow-x: auto; scrollbar-width: none; }
        .tab { padding: 10px 20px; font-size: 13px; white-space: nowrap; cursor: pointer; color: #a2a2a2; flex-shrink: 0; }
        .tab.active { background: var(--primary); color: #0b0e21; border-color: var(--primary); font-weight: bold; box-shadow: 0 0 15px rgba(162, 155, 254, 0.4); }

        #grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 100%; max-width: 400px; }
        .card { padding: 20px 5px; text-align: center; cursor: pointer; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .card:hover { border-color: var(--primary); transform: translateY(-3px); }
        .card:active { transform: scale(0.95); }
        .card img { width: 42px; height: 42px; filter: drop-shadow(0 0 5px var(--primary)); margin-bottom: 10px; }
        .name { font-size: 14px; font-weight: 400; display: block; }

        /* 3. 仪式感弹窗 */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(8px); }
        .modal-content { width: 85%; max-width: 380px; overflow: hidden; animation: pop 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        @keyframes pop { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .modal-head { background: linear-gradient(135deg, var(--primary), #6c5ce7); padding: 20px; text-align: center; font-weight: bold; color: #0b0e21; font-size: 18px; }
        .modal-body { padding: 25px; color: #e0e0e0; max-height: 60vh; overflow-y: auto; }
        
        .item { margin-bottom: 20px; position: relative; padding-left: 15px; }
        .item::before { content: ""; position: absolute; left: 0; top: 2px; bottom: 2px; width: 3px; background: var(--primary); border-radius: 2px; }
        .label { color: var(--primary); font-size: 11px; font-weight: bold; letter-spacing: 1px; margin-bottom: 6px; display: block; }
        .val { font-size: 14px; line-height: 1.7; }
        
        /* 加载动画 */
        .loading-box { text-align: center; padding: 40px 0; }
        .spinner { width: 40px; height: 40px; border: 3px solid rgba(162, 155, 254, 0.2); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .close-btn { width: 100%; padding: 18px; background: transparent; border: none; color: var(--primary); border-top: 1px solid var(--border); cursor: pointer; font-size: 15px; font-weight: bold; }
    </style>
</head>
<body>

    <h1>星语占星 Pro</h1>

    <div class="config-box">
        <div class="input-row">
            <input type="date" id="birth" value="2000-01-01">
            <input type="time" id="time" value="12:00">
        </div>
        <select id="rising" style="width: 100%;">
            <option value="">点击设置上升星座 (更精准)</option>
            <option value="白羊">上升白羊</option><option value="金牛">上升金牛</option>
            <option value="双子">上升双子</option><option value="巨蟹">上升巨蟹</option>
            <option value="狮子">上升狮子</option><option value="处女">上升处女</option>
            <option value="天秤">上升天秤</option><option value="天蝎">上升天蝎</option>
            <option value="射手">上升射手</option><option value="摩羯">上升摩羯</option>
            <option value="水瓶">上升水瓶</option><option value="双鱼">上升双鱼</option>
        </select>
    </div>

    <div class="tabs">
        <div class="tab active" data-m="day">今日运势</div>
        <div class="tab" data-m="year">2026年全运</div>
        <div class="tab" data-m="mbti">MBTI 联动</div>
        <div class="tab" data-m="tarot">每日一牌</div>
    </div>

    <div id="grid"></div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <div id="m-head" class="modal-head"></div>
            <div class="modal-body" id="m-body"></div>
            <button class="close-btn" onclick="closeM()">确认</button>
        </div>
    </div>

    <script>
        let mode = 'day';
        const zodiacs = [
            {n:'白羊', i:'https://img.icons8.com/ios/100/a29bfe/aries.png'},
            {n:'金牛', i:'https://img.icons8.com/ios/100/a29bfe/taurus.png'},
            {n:'双子', i:'https://img.icons8.com/ios/100/a29bfe/gemini.png'},
            {n:'巨蟹', i:'https://img.icons8.com/ios/100/a29bfe/cancer.png'},
            {n:'狮子', i:'https://img.icons8.com/ios/100/a29bfe/leo.png'},
            {n:'处女', i:'https://img.icons8.com/ios/100/a29bfe/virgo.png'},
            {n:'天秤', i:'https://img.icons8.com/ios/100/a29bfe/libra.png'},
            {n:'天蝎', i:'https://img.icons8.com/ios/100/a29bfe/scorpio.png'},
            {n:'射手', i:'https://img.icons8.com/ios/100/a29bfe/sagittarius.png'},
            {n:'摩羯', i:'https://img.icons8.com/ios/100/a29bfe/capricorn.png'},
            {n:'水瓶', i:'https://img.icons8.com/ios/100/a29bfe/aquarius.png'},
            {n:'双鱼', i:'https://img.icons8.com/ios/100/a29bfe/pisces.png'}
        ];

        function getSeed(str) {
            let h = 0;
            for (let i = 0; i < str.length; i++) h = ((h << 5) - h) + str.charCodeAt(i) | 0;
            return Math.abs(h);
        }

        // 核心测算逻辑
        function generate(name) {
            const birthValue = document.getElementById('birth').value;
            const today = new Date().toDateString();
            const seed = getSeed(name + birthValue + today + mode);
            const rise = document.getElementById('rising').value || "本命";
            
            let html = '';
            const headTitle = `${name}座 · ${mode === 'day' ? '今日星图' : '深度报告'}`;

            if(mode === 'day') {
                const houses = ["命宫", "财帛宫", "兄弟宫", "田宅宫", "子女宫", "奴仆宫", "夫妻宫", "疾厄宫", "迁移宫", "官禄宫", "福德宫", "玄秘宫"];
                const transit = ["三分相 (合谐)", "六分相 (机会)", "四分相 (磨砺)", "对分相 (张力)"];
                
                html += `
                    <div class="item"><span class="label">当前相位</span><div class="val">天王星与${name}座太阳呈<b>${transit[seed % 4]}</b>。</div></div>
                    <div class="item"><span class="label">重点宫位</span><div class="val">今日行运落在<b>${houses[seed % 12]}</b>，意味着你需要关注其对应的领域。</div></div>
                    <div class="item"><span class="label">能量指南</span><div class="val">适合穿戴<b>${['琥珀金', '深海蓝', '玫瑰盐', '森林绿'][seed % 4]}</b>色系，增强磁场。</div></div>
                `;
            } else if(mode === 'year') {
                html = `<div class="item"><span class="label">2026 核心词</span><div class="val"><b>【重塑与扩张】</b>。木星将在夏季进入利好相位。</div></div>
                        <div class="item"><span class="label">关键转折</span><div class="val">在 ${(seed%3)+3} 月左右，你会遇到一个改变职场轨迹的贵人。</div></div>`;
            } else if(mode === 'mbti') {
                const mbtis = ["INTJ 建筑师", "ENFP 竞选者", "INFJ 提倡者", "ISTP 鉴赏家", "INFP 调解员"];
                html = `<div class="item"><span class="label">人格镜像</span><div class="val">你的星盘能量今日与 <b>${mbtis[seed % 5]}</b> 产生强烈共振。</div></div>`;
            } else if(mode === 'tarot') {
                const cards = ["星辰 (希望)", "命运之轮 (转机)", "女祭司 (直觉)", "隐士 (思考)", "太阳 (成功)"];
                html = `<div class="item"><span class="label">灵感指引</span><div class="val">今日抽中牌面：<b>【${cards[seed % 5]}】</b>。建议顺势而为。</div></div>`;
            }

            document.getElementById('m-head').innerText = headTitle;
            document.getElementById('m-body').innerHTML = html;
        }

        function closeM() { document.getElementById('modal').style.display = 'none'; }

        window.onload = () => {
            document.querySelectorAll('.tab').forEach(t => {
                t.onclick = function() {
                    document.querySelector('.tab.active').classList.remove('active');
                    this.classList.add('active');
                    mode = this.getAttribute('data-m');
                }
            });

            const grid = document.getElementById('grid');
            zodiacs.forEach(z => {
                const c = document.createElement('div');
                c.className = 'card';
                c.innerHTML = `<img src="${z.i}"><span class="name">${z.n}座</span>`;
                c.onclick = () => {
                    const m = document.getElementById('modal');
                    document.getElementById('m-head').innerText = "星轨链接中...";
                    document.getElementById('m-body').innerHTML = `
                        <div class="loading-box">
                            <div class="spinner"></div>
                            <p style="font-size:12px; color:var(--primary)">正在调取 ${z.n}座 实时星象数据...</p>
                        </div>`;
                    m.style.display = 'flex';
                    setTimeout(() => generate(z.n), 1200);
                };
                grid.appendChild(c);
            });
        };
    </script>
</body>
</html>
